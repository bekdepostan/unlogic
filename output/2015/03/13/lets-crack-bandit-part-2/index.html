<!DOCTYPE html>
<html lang="en">
<head>
		<title>Unlogic &mdash; Let's crack Bandit Part 2</title>
		<meta charset="utf-8" />
		<link rel="profile" href="http://gmpg.org/xfn/11" />
		<link rel="stylesheet" type="text/css" href="/theme/css/style.css" />
		<link rel='stylesheet' id='oswald-css'  href='http://fonts.googleapis.com/css?family=Oswald&#038;ver=3.3.2' type='text/css' media='all' />
		<style type="text/css">
			body.custom-background { background-color: #f5f5f5; }
		</style>
		<link rel="alternate" type="application/atom+xml"
			title="Unlogic — Flux Atom"
			href="/" /> 
		<link rel ="alternate" type="application/rss+xml"
			title="Unlogic — Flux RSS"
			href="/feed.xml" /> 
		<!--[if lte IE 8]><script src="/theme/js/html5shiv.js"></script><![endif]-->
</head>

<body class="home blog custom-background single-author" >
	<div id="container">
		<div id="header">
				<h1 id="site-title"><a href="">Unlogic</a></h1>
<h2 id="site-description">I've got a keyboard, a terminal, and a whole load of luck</h2>		</div><!-- /#banner -->
		
		<div id="menu">
			<div class="menu-navigation-container">
				<ul id="menu-navigation" class="menu">
						<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/pages/about.html">About</a></li>
						<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/pages/all-posts.html">All posts</a></li>
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="http://getpelican.com/">Pelican</a></li>
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="http://python.org/">Python.org</a></li>
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="http://jinja.pocoo.org/">Jinja2</a></li>
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="#">You can modify those links in your config file</a></li>

				</ul>
			</div> <!--/#menu-navigation-container-->
		</div><!-- /#menu -->
		
		<div class="page-title">
		</div>
	
		<div id="contents">

<div class="post type-post status-publish format-standard hentry category-general" id="post">
	<div class="entry-meta">
		<div class="date"><a href="/2015/03/13/lets-crack-bandit-part-2/">Fri 13 March 2015</a></div>
			<div class="comments"><a href="/2015/03/13/lets-crack-bandit-part-2/#disqus_thread" title="Comment on Let's crack Bandit Part 2">comments</a></div>
	</div> <!-- /#entry-meta -->
	<div class="main">
		<h2 class="entry-title">
			<a href="/2015/03/13/lets-crack-bandit-part-2/" title="Permalink to Let's crack Bandit Part 2" rel="bookmark">Let's crack Bandit Part 2</a>
		</h2>
		<div class="entry-content">
			<p>Continues on from <a class="reference external" href="http://unlogic.co.uk/2015/03/13/lets-crack-bandit-part1">Let's crack Bandit Part 1</a></p>
<div class="section" id="level-15-16">
<h2>Level 15 -&gt; 16 #</h2>
<p><a class="reference external" href="http://overthewire.org/wargames/bandit/bandit16.html">Level 15</a></p>
<p>Eventhough this is very similar to the previous level, it's a little
more complicated as we need to connect with SSL.
The simplest way is using <code>openssl</code> with <code>s_client</code>. Once connected it's the
same dance as above</p>
<div class="highlight"><pre><span></span><span class="gp">bandit15@melinda:~$</span> openssl s_client -quiet -connect localhost:30001
<span class="go">depth=0 CN = li190-250.members.linode.com</span>
<span class="go">verify error:num=18:self signed certificate</span>
<span class="go">verify return:1</span>
<span class="go">depth=0 CN = li190-250.members.linode.com</span>
<span class="go">verify return:1</span>
<span class="go">BfMYroe26WYalil77FoDi9qh59eK5xNr</span>
<span class="go">Correct!</span>
<span class="go">cluFn7wTiGryunymYOu4RcffSxQluehd</span>

<span class="go">read:errno=0</span>
</pre></div>
</div>
<div class="section" id="level-16-17">
<h2>Level 16 -&gt; 17 #</h2>
<p><a class="reference external" href="http://overthewire.org/wargames/bandit/bandit17.html">Level 16</a></p>
<p>Here we have a choice. We run a simple ping scan across the port range and then
figure out which port is the right one by trying each one. Depending on the number
of ports open this could take a while or not.
Let's see how we're going to handle this by seeing which ports are open</p>
<div class="highlight"><pre><span></span><span class="gp">bandit16@melinda:~$</span> nmap localhost -p 31000-32000

<span class="go">Starting Nmap 6.40 ( http://nmap.org ) at 2015-03-20 14:54 UTC</span>
<span class="go">Nmap scan report for localhost (127.0.0.1)</span>
<span class="go">Host is up (0.00080s latency).</span>
<span class="go">Not shown: 996 closed ports</span>
<span class="go">PORT      STATE SERVICE</span>
<span class="go">31046/tcp open  unknown</span>
<span class="go">31518/tcp open  unknown</span>
<span class="go">31691/tcp open  unknown</span>
<span class="go">31790/tcp open  unknown</span>
<span class="go">31960/tcp open  unknown</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 0.08 seconds</span>
</pre></div>
<p>Not too bad. Because it's a short list, we can try them one by one, or
we run a service discovery on them. Service discovery in nmap takes a while,
so I only scan the ports we are interseted in:</p>
<div class="highlight"><pre><span></span><span class="gp">bandit16@melinda:~$</span> nmap -sV -p 31046,31518,31691,31790,31960 localhost

<span class="go">Starting Nmap 6.40 ( http://nmap.org ) at 2015-03-20 14:51 UTC</span>
<span class="go">Nmap scan report for localhost (127.0.0.1)</span>
<span class="go">Host is up (0.00015s latency).</span>
<span class="go">PORT      STATE SERVICE VERSION</span>
<span class="go">31046/tcp open  echo</span>
<span class="go">31518/tcp open  msdtc   Microsoft Distributed Transaction Coordinator (error)</span>
<span class="go">31691/tcp open  echo</span>
<span class="go">31790/tcp open  msdtc   Microsoft Distributed Transaction Coordinator (error)</span>
<span class="go">31960/tcp open  echo</span>
<span class="go">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span>
</pre></div>
<p>Now we only have two ports to try, as the others are clearly just echo ports.
Eliminating one we go ahead and</p>
<div class="highlight"><pre><span></span><span class="gp">bandit16@melinda:~$</span> openssl s_client -quiet -connect localhost:31790
<span class="go">depth=0 CN = li190-250.members.linode.com</span>
<span class="go">verify error:num=18:self signed certificate</span>
<span class="go">verify return:1</span>
<span class="go">depth=0 CN = li190-250.members.linode.com</span>
<span class="go">verify return:1</span>
<span class="go">cluFn7wTiGryunymYOu4RcffSxQluehd</span>
<span class="go">Correct!</span>
<span class="go">-----BEGIN RSA PRIVATE KEY-----</span>
<span class="go">MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ</span>
<span class="go">imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ</span>
<span class="go">Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu</span>
<span class="go">DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW</span>
<span class="go">JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX</span>
<span class="go">x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD</span>
<span class="go">KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl</span>
<span class="go">J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd</span>
<span class="go">d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC</span>
<span class="go">YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A</span>
<span class="go">vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama</span>
<span class="go">+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT</span>
<span class="go">8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx</span>
<span class="go">SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd</span>
<span class="go">HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt</span>
<span class="go">SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A</span>
<span class="go">R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi</span>
<span class="go">Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg</span>
<span class="go">R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu</span>
<span class="go">L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni</span>
<span class="go">blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU</span>
<span class="go">YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM</span>
<span class="go">77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b</span>
<span class="go">dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3</span>
<span class="go">vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=</span>
<span class="go">-----END RSA PRIVATE KEY-----</span>

<span class="go">read:errno=0</span>
</pre></div>
<p>Now copy that key into a new file and use <code>chmod go-rw key</code> to remove group
and other read/write. ssh refuses to accept a key that is read/write by
anyone other than the user who owns the file. Then simply</p>
<div class="highlight"><pre><span></span><span class="gp">bandit16@melinda:~$</span> ssh -i /tmp/k.key bandit17@localhost
</pre></div>
</div>
<div class="section" id="level-17-18">
<h2>Level 17 -&gt; 18 #</h2>
<p><a class="reference external" href="http://overthewire.org/wargames/bandit/bandit18.html">Level 17</a></p>
<p>We remain logged in as bandit17 from the previous level. To compare two files
we need to do a <code>diff</code></p>
<div class="highlight"><pre><span></span><span class="gp">bandit17@melinda:~$</span> diff passwords.old  passwords.new
<span class="go">42c42</span>
<span class="go">&lt; BS8bqB1kqkinKJjuxL6k072Qq9NRwQpR</span>
</pre></div>
</div>

		</div> <!--/#entry-content-->
	</div> <!--/#main-->
</div>  <!--/#post-->
	<div id="comments">
		<div id="respond">
			<div id="disqus_thread"></div>
	        <script type="text/javascript">
	            var disqus_shortname = 'unlogic';
	
	            /* * * DON'T EDIT BELOW THIS LINE * * */
	            (function() {
	                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
	                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	            })();
	        </script>
	        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
		</div><!-- #respond -->					
</div><!-- #comments -->

		</div>
		
		<div id="footer">
			<p>Powered by <a href="http://getpelican.com">Pelican</a>, theme by <a href="http://bunnyman.info">tBunnyMan</a>.</p>
<script type="text/javascript">
    var disqus_shortname = 'unlogic';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>		</div><!-- /#footer -->
	</div><!-- /#container -->
	<div style="display:none"></div>
</body>
</html>